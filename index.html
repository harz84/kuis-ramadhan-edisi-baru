<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kuis Ramadhan 2 1447 H</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Gunjala+Gondi&family=Roboto:wght@400;700&family=Signika:wght@400;700&family=Kanit&family=Acme&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://unpkg.com/tone"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
    <style>
        html { height: 100%; margin: 0; padding: 0; }
         body {
            font-family: 'Roboto', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; height: 100%;
            background-color: #1A3C34;
            margin: 0; padding: 0; width: 100%; overflow-x: hidden; position: relative;
        }
        #gameArea {
            background-color: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); text-align: center; max-width: 100%; width: 95%; box-sizing: border-box; position: relative;
        }
        #timerContainer { display: flex; justify-content: center; align-items: center; margin-bottom: 15px; }
        #timerIcon { width: 40px; height: 40px; margin-right: 10px; }
        #timer { font-family: 'Acme', sans-serif; font-size: 40px; color: #2E4A47; }

        #judulGame {
            font-family: 'Signika', sans-serif; font-size: 40px; color: #D4AF37; margin-bottom: 15px; font-weight: bold; box-sizing: border-box; position: relative;
        }
        #judulGame.ramadhan { color: #D4AF37; }

        #petunjuk {
            font-family: 'Noto Sans Gunjala Gondi', sans-serif; font-size: 24px; margin-bottom: 20px; color: #333; line-height: 1.4;
        }

        #pilihanGanda { display: flex; flex-wrap: wrap; justify-content: center; margin-bottom: 20px; }
        #pilihanGanda button {
            font-family: 'Noto Sans Gunjala Gondi', sans-serif; font-size: 18px; padding: 12px 15px; margin: 8px; border: none; border-radius: 8px; background-color: #F5E8C7; color: #2E4A47; cursor: pointer; transition: background-color 0.3s ease; flex: 1 1 100%; max-width: calc(50% - 16px); min-width: 150px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); box-sizing: border-box; display: flex; align-items: center; text-align: left; line-height: 1.4;
        }
        #pilihanGanda button:hover { background-color: #E8DAB2; }
        #pilihanGanda button.selected { background-color: #f0ad4e; }
        #pilihanGanda button.salah { background-color: #FF0000; animation: shake 0.5s; }

        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-5px); } 50% { transform: translateX(5px); } 75% { transform: translateX(-5px); } 100% { transform: translateX(0); } }

        #hasil { font-size: 24px; margin-top: 20px; font-weight: bold; color: #333; }
        .fireworks, .firework { display: none; }

        @media (max-width: 768px) {
            #judulGame { font-size: 30px; }
            #petunjuk { font-size: 18px; }
            #pilihanGanda button { font-size: 15px; padding: 10px 12px; min-width: 100%; max-width: 100%; margin: 6px 0; }
            #hasil { font-size: 20px; }
            #timer { font-size: 30px; }
            #timerIcon { width: 30px; height: 30px; }
        }

        @media (max-width: 600px) {
            #judulGame { font-size: 24px; }
             #petunjuk { font-size: 16px; }
            #pilihanGanda button { font-size: 14px; }
            #timer { font-size: 25px; }
            #timerIcon { width: 25px; height: 25px; }
        }
        #skor { position: absolute; bottom: 10px; right: 10px; font-size: 18px; font-weight: bold; color: #333; }
        #skorBenar { color: #00FF00; }
        #skorSalah { color: #FF0000; }

        #startButton { font-size: 24px; padding: 12px 20px; margin: 8px; border: none; border-radius: 8px; background-color: #F5E8C7; color: #2E4A47; cursor: pointer; transition: background-color 0.3s ease; }
        #startButton:hover { background-color: #E8DAB2; }

        #learnMoreButton { font-size: 18px; padding: 8px 14px; margin: 8px; border: none; border-radius: 8px; background-color: #F5E8C7; color: #2E4A47; cursor: pointer; transition: background-color 0.3s ease; }
        #learnMoreButton:hover { background-color: #E8DAB2; }

        #bismillah { font-size: 20px; color: #333; margin-top: 10px; }
        #skorAkhir { font-size: 28px; font-weight: bold; }

        @keyframes popup { 0% { transform: scale(0); opacity: 0; } 50% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }
        .popup-animation { animation: popup 0.5s ease-in-out forwards; }

        #copyright {
            position: absolute; top: 10px; right: 10px; font-family: 'Kanit', sans-serif; font-size: 14px;
            color: #F5E8C7;
            z-index: 1100;
        }

        #correctAnimation, #wrongAnimation { position: absolute; top: 10px; width: 64px; height: 64px; display: none; z-index: 1050; }
        #correctAnimation { right: 10px; }
        #wrongAnimation { right: 80px; }

        @media (max-width: 768px) { #wrongAnimation { right: 10px; } #correctAnimation { right: 10px; } }

    </style>
</head>
<body>
    <div id="gameArea">
        <div id="timerContainer" style="display: none;">
            <img id="timerIcon" src="https://img.icons8.com/ios-filled/50/2E4A47/hourglass.png" alt="Hourglass">
            <span id="timer">03:00</span> <!-- HTML Display Updated -->
        </div>
        <h1 id="judulGame">Kuis Ramadhan 1447 H</h1>
        <p id="petunjuk">Selamat datang di Kuis Ramadhan!</p>
        <div id="startScreen">
            <input type="text" id="namaPeserta" placeholder="Masukkan Nama Anda" style="padding: 10px; margin-bottom: 15px; font-size: 16px; border-radius: 8px; border: none; width: 80%; max-width: 300px; text-align: center;"><br>
            
            <button id="startButton">Start</button>
            <p id="bismillah">Bismillah</p>
        </div>
        <div id="pilihanGanda" style="display: none;">
            <!-- Buttons generated by JS -->
        </div>
        <p id="hasil"></p>
        <div class="fireworks"></div>
        <div id="correctAnimation"></div>
        <div id="wrongAnimation"></div>
        <div id="skor" style="display: none;">
            Benar: <span id="skorBenar">0</span> / Salah: <span id="skorSalah">0</span>
        </div>
    </div>
    <div id="copyright">Â© Mas Har</div>
    <script>
        // --- Question Data ---
        // --- Question Data ---
        const dataTebakan = [
            { 
                deskripsi: "FIKIH NIAT: Hadits Hafshah mewajibkan niat sebelum terbit fajar (Tabyitun Niyyah). Jika seseorang tertidur dari sesudah Asar hingga azan Subuh keesokan harinya, dan ia belum terbesit niat untuk puasa Ramadhan hari itu, apa hukum puasanya pada hari tersebut menurut pendapat mayoritas ulama (Jumhur)?", 
                jawaban: "Puasanya tidak sah, ia wajib menahan diri dari makan minum seharian itu, dan wajib mengqadhanya di hari lain.", 
                pilihan: ["Puasanya sah karena niat di awal bulan Ramadhan sudah mencukupi untuk sebulan penuh.", "Puasanya tidak sah, ia wajib menahan diri dari makan minum seharian itu, dan wajib mengqadhanya di hari lain.", "Puasanya sah asalkan ia langsung berniat seketika ia bangun setelah azan Subuh.", "Puasanya tidak sah dan ia wajib membayar fidyah tanpa perlu mengqadha."], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "KERINGANAN (RUKHSHAH): Menurut fatwa yang shahih dari Ibnu Abbas dan Ibnu Umar radhiyallahu 'anhum, apakah kewajiban bagi wanita hamil dan menyusui yang tidak berpuasa Ramadhan karena khawatir atas kesehatan fisiknya atau bayinya?", 
                jawaban: "Hanya wajib membayar fidyah (memberi makan orang miskin) tanpa qadha.", 
                pilihan: ["Wajib qadha (mengganti puasa) saja.", "Wajib qadha dan membayar fidyah sekaligus.", "Hanya wajib membayar fidyah (memberi makan orang miskin) tanpa qadha.", "Tidak wajib qadha dan tidak wajib fidyah."], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "PEMBATAL PUASA: Dari berbagai tindakan medis berikut ini, manakah yang MEMBATALKAN puasa menurut fatwa para ulama (seperti Lajnah Daimah dan Syaikh Ibnu Utsaimin)?", 
                jawaban: "Suntikan nutrisi/infus pengganti makanan (Mughaddziyah)", 
                pilihan: ["Menggunakan obat tetes mata atau telinga", "Menggunakan inhaler untuk penderita asma", "Suntikan nutrisi/infus pengganti makanan (Mughaddziyah)", "Suntikan vaksin atau anestesi (bius) lokal"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "FIKIH WAKTU IFTAR: Di masa hidup Nabi ï·º (riwayat Asma' binti Abu Bakar), para sahabat pernah berbuka puasa karena langit sangat mendung, mereka mengira matahari sudah tenggelam. Namun tak lama kemudian matahari terlihat kembali. Apa yang diperintahkan kepada mereka?", 
                jawaban: "Menahan diri hingga Maghrib dan wajib mengqadha puasa hari tersebut", 
                pilihan: ["Melanjutkan makan karena mereka tidak sengaja", "Memuntahkan kembali makanan tersebut dan puasa batal", "Menahan diri hingga Maghrib dan wajib mengqadha puasa hari tersebut", "Puasanya sah dan dilanjutkan hingga Maghrib tanpa perlu qadha"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "ASBABUL WURUD: Rasulullah ï·º pernah bersabda: \"Bukanlah termasuk kebaikan berpuasa saat dalam safar (perjalanan).\" Dalam kondisi (sebab) apakah Nabi ï·º mengucapkan hadits tersebut?", 
                jawaban: "Saat melihat ada kerumunan orang memayungi seorang musafir yang pingsan/kepayahan karena puasa", 
                pilihan: ["Saat melihat ada sahabat yang muntah-muntah di atas untanya", "Saat melihat ada kerumunan orang memayungi seorang musafir yang pingsan/kepayahan karena puasa", "Saat pasukan muslimin sedang bersiap untuk Perang Badar", "Saat para sahabat kehabisan bekal air di tengah padang pasir"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "SEJARAH RAMADHAN: Peristiwa agung Fathu Makkah (Pembebasan kota Makkah) terjadi pada bulan Ramadhan tahun 8 Hijriyah. Tepatnya pada tanggal berapakah peristiwa bersejarah tersebut terjadi?", 
                jawaban: "20 Ramadhan", 
                pilihan: ["17 Ramadhan", "10 Ramadhan", "20 Ramadhan", "27 Ramadhan"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "FIKIH TARAWIH: Pada masa kekhalifahan siapakah kaum muslimin pertama kali dikumpulkan kembali secara berjamaah di bawah satu imam untuk shalat Tarawih selama sebulan penuh, setelah di zaman Nabi ï·º sempat dihentikan agar tidak dianggap wajib?", 
                jawaban: "Umar bin Al-Khattab radhiyallahu 'anhu", 
                pilihan: ["Abu Bakar Ash-Shiddiq radhiyallahu 'anhu", "Umar bin Al-Khattab radhiyallahu 'anhu", "Utsman bin Affan radhiyallahu 'anhu", "Ali bin Abi Thalib radhiyallahu 'anhu"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "KAFFARAH (DENDA): Seorang sahabat melapor kepada Nabi ï·º bahwa ia sengaja berjima' (berhubungan suami istri) di siang hari Ramadhan. Nabi menetapkan Kaffarah yang berurutan. Jika ia tidak mampu memerdekakan budak, apa urutan denda selanjutnya?", 
                jawaban: "Berpuasa 2 bulan berturut-turut", 
                pilihan: ["Memberi makan 60 orang miskin", "Berpuasa 60 hari namun boleh tidak berturut-turut", "Berpuasa 2 bulan berturut-turut", "Membayar denda uang seharga 100 ekor unta"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "FIKIH BEKAM: Terdapat hadits \"Telah berbuka (batal) orang yang membekam dan yang dibekam\". Namun, mayoritas ulama (Jumhur) menetapkan berbekam tidak membatalkan puasa. Dalil shahih apakah dari Ibnu Abbas yang menghapus (nasakh) larangan tersebut?", 
                jawaban: "Nabi ï·º berbekam saat beliau sedang ihram dan sedang berpuasa", 
                pilihan: ["Nabi ï·º memerintahkan sahabat menelan ludah setelah dibekam", "Nabi ï·º berbekam saat beliau sedang ihram dan sedang berpuasa", "Nabi ï·º membayar fidyah setelah beliau berbekam", "Ibnu Abbas berkata bekam hanya batal jika darahnya tertelan"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "PRAKTIK FIDYAH: Sahabat Anas bin Malik di akhir hayatnya sudah sangat tua dan tidak mampu berpuasa, sehingga beliau menunaikan fidyah. Bagaimana cara membayar fidyah yang dipraktikkan oleh Anas bin Malik yang menjadi rujukan para ulama?", 
                jawaban: "Mengumpulkan 30 orang miskin di akhir bulan Ramadhan, lalu menjamu mereka makan besar (daging dan roti) sampai kenyang", 
                pilihan: ["Memberikan uang tunai kepada pengurus masjid di awal bulan", "Membagikan beras mentah 1 kilogram setiap hari kepada tetangga", "Mengumpulkan 30 orang miskin di akhir bulan Ramadhan, lalu menjamu mereka makan besar (daging dan roti) sampai kenyang", "Menyembelih seekor kambing dan memakannya sendiri bersama keluarga"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "ZAKAT FITRAH: Dalam riwayat Abu Sa'id al-Khudri radhiyallahu 'anhu, beliau menyebutkan beberapa jenis makanan pokok yang lazim dikeluarkan sebagai Zakat Fitrah di zaman Nabi ï·º. Manakah di bawah ini yang TIDAK disebutkan secara tekstual dalam hadits tersebut?", 
                jawaban: "Beras merah (Ruz)", 
                pilihan: ["Gandum kering (Sya'ir)", "Kismis (Zabib)", "Keju kering / Susu kering (Aqith)", "Beras merah (Ruz)"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "HUKUM QADHA: Dari Aisyah radhiyallahu 'anha, Rasulullah ï·º bersabda: \"Barangsiapa meninggal dunia dan ia masih memiliki hutang puasa (karena udzur lalu belum sempat qadha), maka...\" Apa kelanjutan hadits (solusi) tersebut?", 
                jawaban: "\"...walinya (ahli warisnya) berpuasa untuknya.\"", 
                pilihan: ["\"...diambilkan dari harta warisannya untuk fidyah.\"", "\"...walinya (ahli warisnya) berpuasa untuknya.\"", "\"...hutang puasanya otomatis gugur karena kematian.\"", "\"...ia akan ditahan di alam kubur hingga ada yang menyedekahkan pahala untuknya.\""], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "KESAKSIAN HILAL: Menurut Sunnah Nabi ï·º, jika langit cerah, berapa jumlah minimal saksi yang adil (tsiqah) untuk menetapkan masuknya bulan Ramadhan, dan berapa minimal saksi untuk menetapkan Idul Fitri (masuknya bulan Syawwal)?", 
                jawaban: "1 orang saksi untuk awal Ramadhan, dan 2 orang saksi untuk Idul Fitri (Syawwal)", 
                pilihan: ["Keduanya cukup 1 orang saksi", "Keduanya minimal harus 2 orang saksi", "1 orang saksi untuk awal Ramadhan, dan 2 orang saksi untuk Idul Fitri (Syawwal)", "2 orang saksi untuk awal Ramadhan, dan 1 orang saksi untuk Idul Fitri (Syawwal)"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "TANDA LAILATUL QADR: Sahabat Ubay bin Ka'ab radhiyallahu 'anhu berani bersumpah bahwa ia mengetahui jatuhnya malam Lailatul Qadr berdasarkan tanda pagi harinya yang dikabarkan oleh Nabi ï·º. Apakah tanda tersebut?", 
                jawaban: "Matahari terbit dengan cerah, berwarna putih terang namun tidak menyilaukan mata (seperti bejana)", 
                pilihan: ["Hujan rintik-rintik di pagi hari tanpa disertai awan hitam", "Udara pagi terasa sangat dingin hingga membekukan embun", "Matahari terbit dengan cerah, berwarna putih terang namun tidak menyilaukan mata (seperti bejana)", "Anjing-anjing tidak menggonggong dan keledai tidak meringkik"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            },
            { 
                deskripsi: "FIKIH PUASA SUNNAH: Nabi ï·º melarang umatnya melakukan Wishaal (puasa bersambung hari tanpa buka dan sahur). Namun, jika ada sahabat yang bersikeras ingin melakukan Wishaal, batas maksimal yang diizinkan oleh Nabi ï·º adalah...", 
                jawaban: "Menyambung sampai waktu Sahur di malam berikutnya", 
                pilihan: ["Menyambung sampai waktu Isya", "Menyambung sampai waktu Sahur di malam berikutnya", "Boleh menyambung 2 hari 2 malam berturut-turut", "Menyambung sampai tengah malam (pertengahan malam)"], 
                judul: "Kuis Ramadhan (Edisi Baru)", kategori: "ramadhan" 
            }
        ];
        // --- END Question Data -â€”
        // --- END Question Data ---

        // --- Global Variables ---
        let soalSaatIni; let synth = new Tone.Synth().toDestination(); let jawabanBenar = false; let skorBenar = 0; let skorSalah = 0; let soalSudahDitampilkan = new Set(); let nomorSoal = 0; const totalSoal = 15; let isStartSoundPlayed = false; let timerInterval = null;
        let timeLeft = 180; // UPDATED: 3 minutes (180 seconds)
        let isGameOverSoundPlayed = false;
        let namaUser = "";

        // --- Functions ---
        function playSound(type, specificAudioFile) { let audioFile; if (type === 'success') audioFile = 'success.wav'; else if (type === 'fail') audioFile = 'gameovertwew.wav'; else if (type === 'start' && !isStartSoundPlayed) { audioFile = 'ping.wav'; isStartSoundPlayed = true; } else if (type === 'gameover' && specificAudioFile) audioFile = specificAudioFile; else if (type) audioFile = type; if (audioFile) { const audio = new Audio(audioFile); audio.play().catch(e => console.error("Error playing sound:", e)); } }
        function updateTimer() { let minutes = Math.floor(timeLeft / 60); let seconds = timeLeft % 60; document.getElementById("timer").textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`; if (timeLeft <= 0) { clearInterval(timerInterval); timerInterval = null; if (nomorSoal < totalSoal) { skorSalah += (totalSoal - nomorSoal); document.getElementById("skorSalah").textContent = skorSalah; } akhirPermainan(); } else { timeLeft--; } }
        function resetPilihan() { const pilihanButtons = document.querySelectorAll("#pilihanGanda button"); pilihanButtons.forEach(button => { button.classList.remove("selected", "salah"); button.style.backgroundColor = ""; button.style.animationPlayState = 'paused'; }); }
        function playCorrectAnimation() { const ac = document.getElementById('correctAnimation'); ac.style.display = 'block'; ac.innerHTML = ''; try { lottie.loadAnimation({ container: ac, renderer: 'svg', loop: false, autoplay: true, path: 'correctan.json' }); } catch (e) { console.error("Lottie Error(C):", e); ac.style.display = 'none'; } setTimeout(() => { ac.style.display = 'none'; }, 2000); }
        function playWrongAnimation() { const aw = document.getElementById('wrongAnimation'); aw.style.display = 'block'; aw.innerHTML = ''; try { lottie.loadAnimation({ container: aw, renderer: 'svg', loop: false, autoplay: true, path: 'wrong.json' }); } catch (e) { console.error("Lottie Error(W):", e); aw.style.display = 'none'; } setTimeout(() => { aw.style.display = 'none'; }, 2000); }

        function mulaiPermainan() {
            document.getElementById("startScreen").style.display = "none";
            document.getElementById("timerContainer").style.display = "flex";
            document.getElementById("pilihanGanda").style.display = "flex";
            document.getElementById("skor").style.display = "block";

            playSound('start');

            if (!timerInterval && timeLeft > 0) { updateTimer(); timerInterval = setInterval(updateTimer, 1000); }
            else if (!timerInterval && timeLeft <= 0) { akhirPermainan(); return; }

            jawabanBenar = false;
            let soalTersedia = dataTebakan.filter(soal => !soalSudahDitampilkan.has(soal.deskripsi));

            if (soalTersedia.length === 0 || nomorSoal >= totalSoal) { if(timerInterval) clearInterval(timerInterval); timerInterval = null; akhirPermainan(); return; }

            nomorSoal++;
            soalSaatIni = soalTersedia[Math.floor(Math.random() * soalTersedia.length)];
            soalSudahDitampilkan.add(soalSaatIni.deskripsi);

            document.getElementById("judulGame").textContent = `Kuis Ramadhan 2 (${nomorSoal}/${totalSoal})`;
            document.getElementById("petunjuk").textContent = soalSaatIni.deskripsi;

            const pilihanContainer = document.getElementById("pilihanGanda");
            pilihanContainer.innerHTML = '';
            const shuffledPilihan = [...soalSaatIni.pilihan].sort(() => Math.random() - 0.5);

            shuffledPilihan.forEach(pilihanText => {
                const button = document.createElement("button"); button.textContent = pilihanText;
                button.onclick = function() { if (!jawabanBenar && timeLeft > 0 && timerInterval) { cekJawaban(pilihanText, button); } };
                pilihanContainer.appendChild(button);
            });

            document.getElementById("hasil").textContent = ""; resetPilihan();
            document.getElementById("skorBenar").textContent = skorBenar; document.getElementById("skorSalah").textContent = skorSalah;
        }

        function cekJawaban(jawabanYangDipilih, buttonElement) {
            const pilihanButtons = document.querySelectorAll("#pilihanGanda button"); pilihanButtons.forEach(btn => btn.onclick = null);
            const normDipilih = jawabanYangDipilih.replace(/["â€œâ€]/g, '"'); const normBenar = soalSaatIni.jawaban.replace(/["â€œâ€]/g, '"');

            if (normDipilih === normBenar) {
                document.getElementById("hasil").textContent = "Benar!"; playCorrectAnimation(); playSound('success'); jawabanBenar = true; skorBenar++;
                document.getElementById("skorBenar").textContent = skorBenar; buttonElement.style.backgroundColor = "#90EE90";
                setTimeout(() => { if (nomorSoal < totalSoal && timeLeft > 0) { mulaiPermainan(); } else { if(timerInterval) clearInterval(timerInterval); timerInterval = null; akhirPermainan(); } }, 1500);
            } else {
                document.getElementById("hasil").textContent = "Salah!"; playWrongAnimation(); playSound('fail'); buttonElement.classList.add("salah"); buttonElement.style.animationPlayState = 'running'; skorSalah++;
                document.getElementById("skorSalah").textContent = skorSalah;
                 pilihanButtons.forEach(btn => { const normBtn = btn.textContent.replace(/["â€œâ€]/g, '"'); if (normBtn === normBenar) { btn.style.backgroundColor = "#90EE90"; } });
                setTimeout(() => { buttonElement.style.animationPlayState = 'paused'; if (nomorSoal < totalSoal && timeLeft > 0) { mulaiPermainan(); } else { if(timerInterval) clearInterval(timerInterval); timerInterval = null; akhirPermainan(); } }, 2000);
            }
        }

        function akhirPermainan() {
            if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }
            if (isGameOverSoundPlayed) return;

            const skorAkhir = totalSoal > 0 ? (skorBenar / totalSoal) * 100 : 0;
            let warnaSkor, komentar, gameOverSoundFile;

            if (skorAkhir < 50) { gameOverSoundFile = 'ast.mp3'; komentar = "Belajar lagi ya....ðŸ˜ŠðŸ˜ðŸ¤­"; warnaSkor = "#FF0000"; }
            else if (skorAkhir <= 84) { gameOverSoundFile = 'alh.mp3'; komentar = "Mantap....ðŸ«¶ðŸ»"; warnaSkor = "#FFA500"; }
            else { gameOverSoundFile = 'masy.mp3'; komentar = "Kamu Luar Biasa...ðŸ‘ðŸ»ðŸ‘ðŸ»ðŸ‘ðŸ»"; warnaSkor = "#008000"; }

            document.getElementById("judulGame").textContent = "Kuis Ramadhan Edisi 1447 H";
             document.getElementById("petunjuk").innerHTML = `
                <span id="skorAkhir" style="color: ${warnaSkor};">Skor Akhir Anda: ${skorAkhir.toFixed(0)}%</span><br>
                Benar: ${skorBenar}<br>Salah: ${skorSalah}<br><br>${komentar}
            `;
            document.getElementById("pilihanGanda").innerHTML = ""; document.getElementById("pilihanGanda").style.display = "none";
            document.getElementById("hasil").textContent = ""; document.getElementById("timerContainer").style.display = "none";
            document.getElementById("skor").style.display = "none";

            playSound('gameover', gameOverSoundFile); isGameOverSoundPlayed = true;
            // --- KODE MENGIRIM DATA KE GOOGLE SHEETS ---
            let dataKuis = {
                waktu: new Date().toLocaleString('id-ID'),
                nama: namaUser,
                skor: skorAkhir.toFixed(0),
                benar: skorBenar,
                salah: skorSalah
            };

            // GANTI 'URL_WEB_APP_ANDA' DENGAN URL YANG ANDA SALIN DI LANGKAH 2
            const scriptURL = 'https://script.google.com/macros/s/AKfycbzcZ-6282s8art10zsRbaadJsa-VDQ_HsXtfHIJFmAH-iav481nDn40hFWU_baiJUVREQ/exec'; 
            
            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(dataKuis)
            }).then(() => {
                console.log("Data berhasil disimpan ke server");
            }).catch(error => console.error('Error!', error.message));
            // --- AKHIR KODE MENGIRIM DATA ---
            const learnMoreButton = document.createElement("button");
            learnMoreButton.textContent = "Belajar Lagi Yuk";
            learnMoreButton.id = "learnMoreButton";
            learnMoreButton.onclick = () => { window.location.href = 'https://drive.google.com/file/d/1Hyh8wZ7K5l2t4aTCtxqXlH8vFnL-C2Qb/view?usp=sharing'; };
            Object.assign(learnMoreButton.style, { fontSize: "18px", padding: "8px 14px", margin: "15px 8px 8px 8px", border: "none", borderRadius: "8px", backgroundColor: "#F5E8C7", color: "#2E4A47", cursor: "pointer", transition: "background-color 0.3s ease" });
            learnMoreButton.onmouseover = () => learnMoreButton.style.backgroundColor = "#E8DAB2";
            learnMoreButton.onmouseout = () => learnMoreButton.style.backgroundColor = "#F5E8C7";
            document.getElementById("gameArea").appendChild(learnMoreButton);
        }

        // Initial Start Button Event Listener
        document.getElementById("startButton").addEventListener("click", () => {
             // Wajib isi nama
             namaUser = document.getElementById("namaPeserta").value;
             if (namaUser.trim() === "") {
                 alert("Silakan masukkan nama Anda terlebih dahulu sebelum memulai kuis!");
                 return;
             }

             skorBenar = 0; skorSalah = 0; nomorSoal = 0; soalSudahDitampilkan.clear(); isGameOverSoundPlayed = false; isStartSoundPlayed = false;
             timeLeft = 180; 
             if(timerInterval) clearInterval(timerInterval); timerInterval = null;
             document.getElementById("skorBenar").textContent = "0"; document.getElementById("skorSalah").textContent = "0";
             const oldLearnButton = document.getElementById("learnMoreButton"); if (oldLearnButton) oldLearnButton.remove();
             document.getElementById("judulGame").textContent = "Kuis Ramadhan 2 1447 H";
             document.getElementById("petunjuk").innerHTML = "Selamat datang, " + namaUser + "! Bersiaplah...";
             document.getElementById("petunjuk").style.color = "#333";
             document.getElementById("skor").style.display = "none";
             mulaiPermainan();
        });

    </script>
</body>
</html>