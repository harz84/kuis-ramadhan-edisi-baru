<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kuis Ngabuburit Ramadhan 1447 H</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
    
    <style>
        * { box-sizing: border-box; }
        
        html, body { 
            height: 100%; margin: 0; padding: 0; 
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden;
        }

        /* --- BACKGROUND & PERBAIKAN LAYAR HP --- */
        body {
            display: flex; justify-content: center; align-items: flex-start; 
            min-height: 100vh;
            padding: 80px 15px 40px 15px; /* Menambah ruang atas agar tidak tertutup timer melayang */
            background: linear-gradient(-45deg, #0f3e33, #155d4c, #0a2e3f, #1f2b38);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: #ffffff;
            overflow-y: auto; 
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- GLASSMORPHISM GAME AREA --- */
        #gameArea {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px; 
            padding: 40px 20px 60px 20px; 
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3); 
            text-align: center; 
            max-width: 800px; 
            width: 100%; 
            position: relative;
            margin: auto; 
        }

        /* --- TIMER MELAYANG (FLOATING) --- */
        #timerContainer { 
            position: fixed; /* Membuatnya selalu menempel di layar */
            top: 15px; 
            left: 50%; 
            transform: translateX(-50%); /* Menempatkannya tepat di tengah */
            z-index: 1200; /* Selalu di lapisan paling atas */
            display: none; 
            justify-content: center; 
            align-items: center; 
            background: rgba(0, 0, 0, 0.75); /* Sedikit gelap agar kontras dengan soal */
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            padding: 8px 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
        }
        #timerIcon { width: 28px; height: 28px; margin-right: 10px; filter: brightness(0) invert(1); }
        #timer { font-size: 28px; font-weight: 700; color: #fff; letter-spacing: 2px; margin: 0; line-height: 1; }
        
        .pulse-danger { animation: pulseRed 1s infinite; color: #ff6b6b !important; }
        @keyframes pulseRed { 0% { transform: scale(1); } 50% { transform: scale(1.1); text-shadow: 0 0 10px red; } 100% { transform: scale(1); } }

        /* --- TYPOGRAPHY --- */
        #judulGame { 
            font-size: 36px; color: #F5D061; margin-bottom: 15px; font-weight: 700; 
            text-shadow: 2px 2px 8px rgba(0,0,0,0.4); 
            line-height: 1.3;
        }
        #petunjuk { font-size: 18px; margin-bottom: 25px; line-height: 1.6; font-weight: 400; color: #eef; }

        /* --- ANIMASI TRANSISI SOAL --- */
        .fade-in-up { animation: fadeInUp 0.6s ease forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- TOMBOL PILIHAN GANDA (MODERN) --- */
        #pilihanGanda { display: flex; flex-direction: column; gap: 12px; margin-bottom: 10px; }
        #pilihanGanda button {
            font-family: 'Poppins', sans-serif; 
            font-size: 15px; 
            padding: 15px 20px; 
            border: 1px solid rgba(255, 255, 255, 0.3); 
            border-radius: 12px; 
            background: rgba(255, 255, 255, 0.85); 
            color: #1a2a26; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            text-align: left; 
            line-height: 1.4;
            font-weight: 600;
        }
        #pilihanGanda button:hover { 
            background: #ffffff; 
            transform: translateY(-3px) scale(1.02); 
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); 
        }
        #pilihanGanda button.salah { background-color: #ff6b6b !important; color: white; animation: shake 0.5s; border: none; }
        #pilihanGanda button.benar { background-color: #51cf66 !important; color: white; border: none; }

        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-5px); } 50% { transform: translateX(5px); } 75% { transform: translateX(-5px); } 100% { transform: translateX(0); } }

        /* --- INPUT & TOMBOL MULAI --- */
        #namaPeserta {
            padding: 15px; margin-bottom: 25px; font-size: 16px; border-radius: 12px; 
            border: 2px solid transparent; width: 85%; max-width: 320px; text-align: center;
            background: rgba(255,255,255,0.9); font-family: 'Poppins', sans-serif;
            outline: none; transition: 0.3s;
        }
        #namaPeserta:focus { border: 2px solid #F5D061; box-shadow: 0 0 15px rgba(245, 208, 97, 0.5); background: #ffffff; }
        
        #startButton { 
            font-size: 18px; padding: 14px 35px; border: none; border-radius: 50px; 
            background: linear-gradient(135deg, #F5D061, #e6b12c); color: #1a2a26; 
            cursor: pointer; font-weight: bold; transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(245, 208, 97, 0.4); text-transform: uppercase; letter-spacing: 1px;
        }
        #startButton:hover { transform: scale(1.05); box-shadow: 0 6px 20px rgba(245, 208, 97, 0.6); }

        /* TEKS BISMILLAH DIPERBESAR */
        #bismillah { font-size: 40px; color: rgba(255,255,255,0.8); margin-top: 15px; font-style: normal; font-weight: normal;}
        
        #hasil { font-size: 22px; margin-top: 15px; font-weight: bold; min-height: 33px; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
        
        #skor { position: absolute; bottom: 20px; right: 0; left: 0; font-size: 16px; font-weight: bold; color: rgba(255,255,255,0.8); text-align: center;}
        #skorBenar { color: #51cf66; }
        #skorSalah { color: #ff6b6b; }

        #copyright { position: fixed; bottom: 10px; right: 15px; font-size: 12px; color: rgba(255,255,255,0.5); z-index: 1100; }

        /* POSISI ANIMASI DI SAMPING KANAN TEKS JUDUL SOAL */
        #correctAnimation, #wrongAnimation { 
            position: absolute; 
            left: 100%; 
            top: 50%; 
            transform: translateY(-50%); 
            margin-left: 12px; 
            width: 50px; 
            height: 50px; 
            display: none; 
            z-index: 1050; 
            pointer-events: none; 
        }

        /* RESPONSIVE UNTUK HP */
        @media (max-width: 768px) {
            body { padding: 70px 10px 20px 10px; } /* Jarak atas ditambah agar timer tidak menutupi kuis */
            #judulGame { font-size: 26px; }
            #petunjuk { font-size: 15px; }
            #pilihanGanda button { font-size: 14px; padding: 12px 15px; }
            #gameArea { padding: 30px 15px 50px 15px; }
            #correctAnimation, #wrongAnimation { width: 45px; height: 45px; margin-left: 8px; }
            
            /* Penyesuaian Timer untuk HP */
            #timerContainer { top: 10px; padding: 6px 15px; }
            #timer { font-size: 22px; }
            #timerIcon { width: 20px; height: 20px; }
        }
    </style>
</head>
<body>
    <div id="timerContainer" style="display: none;">
        <img id="timerIcon" src="https://img.icons8.com/ios-filled/50/ffffff/hourglass.png" alt="Hourglass">
        <span id="timer">07:00</span>
    </div>

    <div id="gameArea">
        <div id="startScreen" class="fade-in-up">
            <h1 id="judulGame">Kuis Ngabuburit<br>Ramadhan 1447 H</h1>
            <p id="petunjuk" style="font-size: 16px;">Uji pengetahuan Islam kamu sambil menunggu waktu berbuka puasa!</p>
            
            <input type="text" id="namaPeserta" placeholder="Ketik Nama Anda Di Sini"><br>
            <button id="startButton">Mulai Kuis</button>
            <p id="bismillah">Ô∑Ω</p>
        </div>

        <div id="judulSoalWrapper" class="fade-in-up" style="display: none; text-align: center; margin-bottom: 15px;">
            <div style="display: inline-flex; align-items: center; position: relative;">
                <h1 id="judulGameAktif" style="font-size: 20px; color: #F5D061; margin: 0;"></h1>
                <div id="correctAnimation"></div>
                <div id="wrongAnimation"></div>
            </div>
        </div>

        <p id="petunjukSoal" class="fade-in-up" style="display: none;"></p>
        
        <div id="pilihanGanda" class="fade-in-up" style="display: none;">
            </div>
        
        <p id="hasil"></p>
        
        <div id="skor" style="display: none;">
            ‚úÖ Benar: <span id="skorBenar">0</span> &nbsp;|&nbsp; ‚ùå Salah: <span id="skorSalah">0</span>
        </div>
    </div>
    
    <div id="copyright">¬© Mas Har 2026</div>

    <script>
        // --- SOAL TERBARU ---
        const dataTebakan = [
            { 
                deskripsi: "Kapankah waktu yang paling afdhal (utama) untuk mengeluarkan zakat fitrah menurut sunnah Nabi Ô∑∫?", 
                jawaban: "Mulai terbenamnya matahari di malam Idul Fitri hingga sebelum pelaksanaan shalat Idul Fitri", 
                pilihan: ["Sejak hari pertama masuknya bulan Ramadhan", "Pada pertengahan bulan Ramadhan (tanggal 15)", "Mulai terbenamnya matahari di malam Idul Fitri hingga sebelum pelaksanaan shalat Idul Fitri", "Kapan saja setelah shalat Idul Fitri selesai dilaksanakan pada hari itu"] 
            },
            { 
                deskripsi: "Jika seorang wanita mendapati keluarnya darah istihadhah (darah penyakit yang keluar di luar kebiasaan masa haid) di siang hari bulan Ramadhan, apa yang syariat tetapkan untuknya?", 
                jawaban: "Tetap melanjutkan puasanya karena darah istihadhah tidak menghalangi sahnya ibadah puasa", 
                pilihan: ["Membatalkan puasanya dan wajib mengqadha di luar bulan Ramadhan", "Tetap melanjutkan puasanya karena darah istihadhah tidak menghalangi sahnya ibadah puasa", "Membatalkan puasanya dan cukup membayar fidyah sebagai pengganti", "Menghentikan puasanya sementara waktu sampai darahnya berhenti menetes di hari itu juga"] 
            },
            { 
                deskripsi: "Bagaimana hukum bagi orang yang berpuasa memakai minyak wangi (parfum) di tubuh/pakaiannya atau tak sengaja mencium aroma masakan tetangga di siang hari Ramadhan?", 
                jawaban: "Boleh (mubah) dan tidak membatalkan puasa selama wujud fisiknya tidak dihirup langsung ke tenggorokan (seperti sengaja menghirup kepulan asap dupa)", 
                pilihan: ["Membatalkan puasa jika aromanya terlampau kuat dan tajam", "Makruh dan mengurangi pahala kesabaran dalam berpuasa", "Boleh (mubah) dan tidak membatalkan puasa selama wujud fisiknya tidak dihirup langsung ke tenggorokan (seperti sengaja menghirup kepulan asap dupa)", "Batal dan ia wajib mengganti puasanya di hari lain"] 
            },
            { 
                deskripsi: "Ketika berwudhu di siang hari Ramadhan, Rasulullah Ô∑∫ memberikan instruksi khusus terkait istinsyaq (menghirup air ke hidung). Instruksi apakah itu?", 
                jawaban: "Dilarang bersungguh-sungguh (terlalu dalam) saat istinsyaq agar terhindar dari masuknya air ke tenggorokan", 
                pilihan: ["Dilarang melakukan istinsyaq sama sekali selama berpuasa", "Cukup mengusap hidung bagian luar saja dengan jari yang basah", "Dilarang bersungguh-sungguh (terlalu dalam) saat istinsyaq agar terhindar dari masuknya air ke tenggorokan", "Wajib menggunakan air yang bersuhu hangat agar tidak membatalkan puasa"] 
            },
            { 
                deskripsi: "Seseorang yang sedang berpuasa merasa mual karena masuk angin. Ia lalu sengaja memasukkan jarinya ke tenggorokan agar bisa muntah dan merasa lega. Bagaimana status puasanya?", 
                jawaban: "Batal dan ia diwajibkan untuk mengqadha puasanya di hari lain", 
                pilihan: ["Tetap sah karena muntah tersebut dilakukan demi pengobatan orang yang sakit", "Batal dan ia diwajibkan untuk mengqadha puasanya di hari lain", "Sah namun ia berdosa karena menyiksa dirinya sendiri", "Batal dan ia wajib membayar kaffarah (berpuasa dua bulan berturut-turut)"] 
            },
            { 
                deskripsi: "Berapa malamkah Rasulullah Ô∑∫ melaksanakan shalat Tarawih (Qiyamul Lail) secara berjamaah bersama para sahabat di masjid, sebelum akhirnya beliau menghentikannya karena khawatir amalan tersebut akan diwajibkan atas umatnya?", 
                jawaban: "Hanya sekitar tiga atau empat malam saja", 
                pilihan: ["Satu bulan penuh (29 atau 30 malam)", "Pada sepuluh malam terakhir bulan Ramadhan saja", "Hanya sekitar tiga atau empat malam saja", "Beliau sama sekali tidak pernah melaksanakan shalat Tarawih berjamaah di masjid"] 
            },
            { 
                deskripsi: "Jika seorang wanita sedang beriktikaf di masjid pada malam-malam terakhir bulan Ramadhan, lalu tiba-tiba darah haidnya keluar malam itu juga, apa tindakan wajib yang harus ia lakukan?", 
                jawaban: "Segera keluar meninggalkan masjid dan membatalkan iktikafnya karena wanita haid dilarang berdiam diri (al-muktsu) di dalam masjid", 
                pilihan: ["Tetap berdiam di tempatnya dalam masjid dengan syarat menggunakan pembalut yang rapat agar darah tidak menetes", "Berpindah ke pelataran/halaman masjid dan melanjutkan niat iktikafnya di sana", "Segera keluar meninggalkan masjid dan membatalkan iktikafnya karena wanita haid dilarang berdiam diri (al-muktsu) di dalam masjid", "Tetap di masjid namun mengganti niat iktikafnya menjadi sekadar niat berdzikir biasa"] 
            },
            { 
                deskripsi: "Seseorang sedang makan sahur dan kebetulan masih memegang gelas air minum di tangannya yang belum sempat ia tenggak. Tiba-tiba muadzin mengumandangkan azan Subuh. Berdasarkan sunnah Nabi Ô∑∫, apa keringanan yang diberikan untuknya?", 
                jawaban: "Boleh (diberi keringanan) untuk meminumnya sebagai tuntasan hajatnya dari gelas yang sedang dipegangnya tersebut", 
                pilihan: ["Ia wajib membuang air tersebut dan membatalkan niat puasanya karena sudah kedaluwarsa", "Boleh (diberi keringanan) untuk meminumnya sebagai tuntasan hajatnya dari gelas yang sedang dipegangnya tersebut", "Haram baginya meminumnya meskipun hanya seteguk, dan puasanya batal jika ia menelannya", "Ia hanya dibolehkan untuk berkumur-kumur dengan air tersebut tanpa boleh menelannya"] 
            },
            { 
                deskripsi: "Apa hukum ibadah puasa bagi seseorang yang kehilangan akal sehatnya (gila) selama satu bulan penuh di bulan Ramadhan, dan apakah walinya wajib membayarkan fidyah untuknya?", 
                jawaban: "Tidak ada kewajiban puasa, kewajiban qadha, maupun kewajiban fidyah baginya karena pena pencatatan amal (taklif) telah diangkat darinya", 
                pilihan: ["Walinya wajib menuntaskan pembayaran fidyah dari harta orang tersebut sebagai ganti puasanya", "Tidak ada kewajiban puasa, kewajiban qadha, maupun kewajiban fidyah baginya karena pena pencatatan amal (taklif) telah diangkat darinya", "Walinya secara syar'i diwajibkan berpuasa sebulan penuh untuk menggantikannya", "Puasanya gugur, namun kelak wajib diqadha seluruhnya jika suatu saat ia sembuh dari gilanya"] 
            },
            { 
                deskripsi: "Meyakini dengan sepenuh hati bahwa Allah 'Azza wa Jalla adalah satu-satunya Pencipta, Pemberi Rezeki, Pengatur alam semesta, dan Dzat yang Menghidupkan serta Mematikan termasuk dalam kategori tauhid apa?", 
                jawaban: "Tauhid Rububiyah", 
                pilihan: ["Tauhid Asma' wa Sifat", "Tauhid Rububiyah", "Tauhid Uluhiyah", "Tauhid Hakimiyah"] 
            },
            { 
                deskripsi: "Jika seorang muslim sengaja membatalkan puasa Ramadhannya tanpa adanya uzur syar'i (seperti sengaja makan siang tanpa alasan), menurut pendapat yang kuat dari sebagian muhaqqiqin (seperti Syaikhul Islam Ibnu Taimiyah), apakah ia dituntut untuk mengqadhanya?", 
                jawaban: "Tidak bisa diqadha karena waktu khusus ibadahnya telah ia langgar dengan sengaja; ia wajib bertaubat nasuha dan memperbanyak puasa sunnah", 
                pilihan: ["Ya, ia diwajibkan mengqadha berapapun jumlah puasa yang ia tinggalkan", "Ya, ia diwajibkan mengqadha ditambah denda memerdekakan seorang budak muslim", "Tidak bisa diqadha karena waktu khusus ibadahnya telah ia langgar dengan sengaja; ia wajib bertaubat nasuha dan memperbanyak puasa sunnah", "Tidak diqadha, melainkan cukup menggantinya dengan membayar fidyah kepada panti asuhan"] 
            },
            { 
                deskripsi: "Banyak umat Islam berlomba mengkhatamkan Al-Qur'an di bulan Ramadhan. Bagaimana hukum membaca Al-Qur'an murni dari hafalan (tanpa menyentuh fisik mushaf) bagi orang yang berhadats kecil (belum berwudhu)?", 
                jawaban: "Diperbolehkan dan tidak dilarang, meskipun membaca dalam kondisi berwudhu jauh lebih utama (afdhal)", 
                pilihan: ["Haram dan berdosa karena kalamullah harus dibaca dalam kondisi suci", "Makruh tahrim, amalan tersebut lebih baik ditunda sampai ia berwudhu", "Diperbolehkan dan tidak dilarang, meskipun membaca dalam kondisi berwudhu jauh lebih utama (afdhal)", "Puasa orang yang melakukannya di siang hari menjadi cacat atau berkurang pahalanya"] 
            },
            { 
                deskripsi: "Apakah orang-orang mukmin akan melihat wajah Allah 'Azza wa Jalla pada hari kiamat dan di surga kelak menurut aqidah Ahlussunnah berdasarkan dalil Al-Qur'an dan Sunnah?", 
                jawaban: "Ya, mereka akan melihat-Nya secara hakiki dengan mata kepala mereka sendiri sebagai nikmat tertinggi", 
                pilihan: ["Ya, mereka akan melihat-Nya secara hakiki dengan mata kepala mereka sendiri sebagai nikmat tertinggi", "Tidak, karena Allah mustahil dapat dilihat oleh mata makhluk sampai kapanpun", "Ya, namun hanya berupa cahaya abstrak di dalam hati masing-masing", "Hanya Nabi Muhammad Ô∑∫ yang diberikan kekhususan bisa melihat-Nya kelak"] 
            },
            { 
                deskripsi: "Menurut ketetapan Al-Qur'an dan Sunnah, siapakah yang berhak memberikan atau mendapatkan syafa'at (pertolongan) kelak pada hari kiamat?", 
                jawaban: "Hanya mereka yang diizinkan oleh Allah serta diridhai perkataan dan perbuatannya", 
                pilihan: ["Siapa saja yang berstatus wali atau orang shalih secara mutlak", "Hanya malaikat pemikul 'Arsy dan malaikat maut", "Hanya mereka yang diizinkan oleh Allah serta diridhai perkataan dan perbuatannya", "Para Nabi dan Rasul meskipun tanpa izin dari Allah terlebih dahulu"] 
            },
            { 
                deskripsi: "Seseorang melakukan perjalanan jauh (safar) dari Jakarta ke Kualalumpur menggunakan pesawat terbang kelas utama yang sangat nyaman dan cepat hanya dua jam sehingga ia sama sekali tidak merasa lapar atau kelelahan. Apakah ia tetap berhak mendapatkan rukhshah (keringanan) untuk tidak berpuasa?", 
                jawaban: "Ya, ia berhak berbuka karena syariat mengaitkan rukhshah safar dengan \"jarak perjalanan\", bukan dengan tingkat kepayahannya", 
                pilihan: ["Tidak, karena alasan rukhshah puasa adalah kepayahan (masyaqqah), sehingga jika tidak payah ia wajib berpuasa", "Ya, ia berhak berbuka karena syariat mengaitkan rukhshah safar dengan \"jarak perjalanan\", bukan dengan tingkat kepayahannya", "Boleh berbuka asalkan ia sanggup membayar kaffarah tambahan nantinya", "Ia wajib menahan diri hingga tiba di tujuan, baru kemudian ia boleh berbuka"] 
            }
        ];

        // --- Variabel Global ---
        let soalSaatIni; let jawabanBenar = false; let skorBenar = 0; let skorSalah = 0; 
        let soalSudahDitampilkan = new Set(); let nomorSoal = 0; const totalSoal = 15; 
        let timerInterval = null; let timeLeft = 720; // 7 menit
        let isGameOverSoundPlayed = false; let namaUser = "";

        // --- Audio Sederhana ---
        function playSound(type) {
            let src = '';
            if(type === 'start') src = 'ping.wav';
            else if(type === 'success') src = 'success.wav';
            else if(type === 'fail') src = 'gameovertwew.wav';
            else src = type; 
            
            if(src) {
                let audio = new Audio(src);
                audio.play().catch(e => console.log("Audio play prevented:", e));
            }
        }

        function updateTimer() { 
            let minutes = Math.floor(timeLeft / 60); 
            let seconds = timeLeft % 60; 
            const timerEl = document.getElementById("timer");
            timerEl.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`; 
            
            if(timeLeft <= 30) timerEl.classList.add("pulse-danger");
            else timerEl.classList.remove("pulse-danger");

            if (timeLeft <= 0) { 
                clearInterval(timerInterval); timerInterval = null; 
                if (nomorSoal < totalSoal) { skorSalah += (totalSoal - nomorSoal); } 
                akhirPermainan(); 
            } else { 
                timeLeft--; 
            } 
        }

        function triggerAnimation(elementId) {
            const el = document.getElementById(elementId);
            el.classList.remove("fade-in-up");
            void el.offsetWidth; // trigger reflow
            el.classList.add("fade-in-up");
        }

        function playLottieAnimation(type) { 
            const container = document.getElementById(type === 'correct' ? 'correctAnimation' : 'wrongAnimation');
            container.style.display = 'block'; container.innerHTML = ''; 
            try { 
                lottie.loadAnimation({ container: container, renderer: 'svg', loop: false, autoplay: true, path: type === 'correct' ? 'correctan.json' : 'wrong.json' }); 
            } catch (e) {} 
            setTimeout(() => { container.style.display = 'none'; }, 2000); 
        }

        function mulaiPermainan() {
            document.getElementById("startScreen").style.display = "none";
            document.getElementById("timerContainer").style.display = "flex"; // Timer dimunculkan dengan flex
            
            const judulSoalWrapper = document.getElementById("judulSoalWrapper");
            const judulGameAktif = document.getElementById("judulGameAktif");
            const petunjukSoal = document.getElementById("petunjukSoal");
            const pilihanGanda = document.getElementById("pilihanGanda");
            
            judulSoalWrapper.style.display = "block";
            petunjukSoal.style.display = "block";
            pilihanGanda.style.display = "flex";
            document.getElementById("skor").style.display = "block";

            if (!timerInterval && timeLeft > 0) { updateTimer(); timerInterval = setInterval(updateTimer, 1000); }

            jawabanBenar = false;
            let soalTersedia = dataTebakan.filter(soal => !soalSudahDitampilkan.has(soal.deskripsi));

            if (soalTersedia.length === 0 || nomorSoal >= totalSoal) { 
                akhirPermainan(); return; 
            }

            nomorSoal++;
            soalSaatIni = soalTersedia[Math.floor(Math.random() * soalTersedia.length)];
            soalSudahDitampilkan.add(soalSaatIni.deskripsi);

            judulGameAktif.textContent = `Soal ${nomorSoal} dari ${totalSoal}`;
            petunjukSoal.textContent = soalSaatIni.deskripsi;
            
            triggerAnimation("judulSoalWrapper");
            triggerAnimation("petunjukSoal");
            triggerAnimation("pilihanGanda");

            pilihanGanda.innerHTML = '';
            const shuffledPilihan = [...soalSaatIni.pilihan].sort(() => Math.random() - 0.5);

            shuffledPilihan.forEach(pilihanText => {
                const button = document.createElement("button"); 
                button.textContent = pilihanText;
                button.onclick = function() { 
                    if (!jawabanBenar && timeLeft > 0) cekJawaban(pilihanText, button); 
                };
                pilihanGanda.appendChild(button);
            });

            document.getElementById("hasil").textContent = ""; 
            document.getElementById("skorBenar").textContent = skorBenar; 
            document.getElementById("skorSalah").textContent = skorSalah;
        }

        function cekJawaban(jawabanYangDipilih, buttonElement) {
            const pilihanButtons = document.querySelectorAll("#pilihanGanda button"); 
            pilihanButtons.forEach(btn => btn.style.pointerEvents = 'none'); 
            
            if (jawabanYangDipilih === soalSaatIni.jawaban) {
                document.getElementById("hasil").textContent = "‚ú® Jawaban Benar!"; 
                document.getElementById("hasil").style.color = "#51cf66";
                playLottieAnimation('correct'); playSound('success'); 
                jawabanBenar = true; skorBenar++;
                buttonElement.classList.add("benar");
            } else {
                document.getElementById("hasil").textContent = "‚ùå Jawaban Salah!"; 
                document.getElementById("hasil").style.color = "#ff6b6b";
                playLottieAnimation('wrong'); playSound('fail'); 
                skorSalah++;
                buttonElement.classList.add("salah");
                
                pilihanButtons.forEach(btn => { 
                    if (btn.textContent === soalSaatIni.jawaban) btn.classList.add("benar"); 
                });
            }
            
            document.getElementById("skorBenar").textContent = skorBenar;
            document.getElementById("skorSalah").textContent = skorSalah;

            setTimeout(() => { 
                if (nomorSoal < totalSoal && timeLeft > 0) mulaiPermainan(); 
                else akhirPermainan(); 
            }, 2000);
        }

        function akhirPermainan() {
            if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }
            if (isGameOverSoundPlayed) return;

            const skorAkhir = totalSoal > 0 ? (skorBenar / totalSoal) * 100 : 0;
            let warnaSkor, komentar, gameOverSoundFile;

            if (skorAkhir < 50) { gameOverSoundFile = 'ast.mp3'; komentar = "Belajar lagi ya.... üòäüìö"; warnaSkor = "#ff6b6b"; }
            else if (skorAkhir <= 84) { gameOverSoundFile = 'alh.mp3'; komentar = "Alhamdulillah, Mantap! üëç"; warnaSkor = "#F5D061"; }
            else { gameOverSoundFile = 'masy.mp3'; komentar = "MasyaAllah, Kamu Luar Biasa! üåüüèÜ"; warnaSkor = "#51cf66"; }

            document.getElementById("judulGameAktif").textContent = "Kuis Selesai!";
            document.getElementById("timerContainer").style.display = "none";
            document.getElementById("skor").style.display = "none";
            document.getElementById("pilihanGanda").style.display = "none";
            document.getElementById("hasil").style.display = "none";

            const petunjuk = document.getElementById("petunjukSoal");
            petunjuk.innerHTML = `
                <div style="font-size: 24px; margin-bottom: 15px;">Alhamdulillah, Terima kasih <b>${namaUser}</b>!</div>
                <div style="font-size: 40px; font-weight: bold; color: ${warnaSkor}; text-shadow: 0 0 10px rgba(0,0,0,0.5); margin: 20px 0;">Nilai: ${skorAkhir.toFixed(0)}</div>
                <div style="font-size: 18px; display: inline-block; text-align: left; background: rgba(0,0,0,0.2); padding: 15px 30px; border-radius: 15px;">
                    ‚úÖ Benar: <b>${skorBenar}</b><br>
                    ‚ùå Salah: <b>${skorSalah}</b>
                </div>
                <div style="margin-top: 20px; font-size: 22px; color: #fff;">${komentar}</div>
            `;
            triggerAnimation("judulSoalWrapper");
            triggerAnimation("petunjukSoal");

            playSound(gameOverSoundFile); isGameOverSoundPlayed = true;

            // --- PENGIRIMAN DATA KE GOOGLE SHEETS ---
            const scriptURL = 'https://script.google.com/macros/s/AKfycbzcZ-6282s8art10zsRbaadJsa-VDQ_HsXtfHIJFmAH-iav481nDn40hFWU_baiJUVREQ/exec'; 
            
            let dataKuis = { waktu: new Date().toLocaleString('id-ID'), nama: namaUser, skor: skorAkhir.toFixed(0), benar: skorBenar, salah: skorSalah };
            fetch(scriptURL, { method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(dataKuis) })
            .then(() => console.log("Data tersimpan di server")).catch(e => console.error('Error!', e));

            // Tombol Bonus eBook
            const learnBtn = document.createElement("button");
            learnBtn.textContent = "üìñ Bonus e-Book Ramadhan";
            learnBtn.onclick = () => window.location.href = 'https://drive.google.com/file/d/1hWKJqHEpmtaPVIaIVBsbU_2iFRCKIZS6/view';
            Object.assign(learnBtn.style, { fontSize: "16px", padding: "12px 20px", marginTop: "30px", border: "none", borderRadius: "50px", background: "linear-gradient(135deg, #F5D061, #e6b12c)", color: "#1a2a26", cursor: "pointer", fontWeight: "bold", transition: "0.3s", boxShadow: "0 4px 15px rgba(245, 208, 97, 0.4)" });
            learnBtn.onmouseover = () => learnBtn.style.transform = "scale(1.05)";
            learnBtn.onmouseout = () => learnBtn.style.transform = "scale(1)";
            document.getElementById("gameArea").appendChild(learnBtn);
        }

        // --- EVENT MULAI ---
        document.getElementById("startButton").addEventListener("click", () => {
             namaUser = document.getElementById("namaPeserta").value;
             if (namaUser.trim() === "") { alert("Mohon isi nama Anda sebelum mulai!"); return; }

             skorBenar = 0; skorSalah = 0; nomorSoal = 0; soalSudahDitampilkan.clear(); 
             isGameOverSoundPlayed = false; timeLeft = 420; 
             playSound('start');
             mulaiPermainan();
        });
    </script>
</body>
</html>